import enum
from typing import Optional

from sqlalchemy import (Boolean, Column, Enum, ForeignKey, Integer, String,
                        UniqueConstraint)
from sqlalchemy.orm import relationship

from app.db.base_class import Base
from app.utils.mixins import TimestampMixin


class Endpoint(TimestampMixin, Base):
    endpoint = Column(String)
    is_scanned = Column(Boolean, default=False)
    domain_id = Column(Integer, ForeignKey("domain.id", ondelete="CASCADE"))
    domain = relationship("Domain", back_populates="endpoints")
    subdomain_id = Column(Integer, ForeignKey("subdomain.id", ondelete="CASCADE"))
    subdomain = relationship("Subdomain", back_populates="endpoints")
    project_id = Column(Integer, ForeignKey("project.id", ondelete="CASCADE"))
    project = relationship("Project", back_populates="endpoints")
    __table_args__ = (
        UniqueConstraint("endpoint", "project_id", name="unique_endpoint"),
        {},
    )
