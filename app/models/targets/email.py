from sqlalchemy import (Boolean, Column, ForeignKey, Integer, String,
                        UniqueConstraint)
from sqlalchemy.orm import relationship

from app.db.base_class import Base
from app.utils.mixins import TimestampMixin


class Email(TimestampMixin, Base):
    email = Column(String, nullable=True)
    is_scanned = Column(Boolean, default=False)
    domain_id = Column(Integer, ForeignKey("domain.id", ondelete="CASCADE"))
    domain = relationship("Domain", back_populates="emails")
    project_id = Column(Integer, ForeignKey("project.id", ondelete="CASCADE"))
    project = relationship("Project", back_populates="domains")
    __table_args__ = (UniqueConstraint("email", "project_id", name="unique_email"), {})
