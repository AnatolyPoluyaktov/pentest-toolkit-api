from sqlalchemy import (Boolean, Column, ForeignKey, Integer, String, Table,
                        UniqueConstraint)
from sqlalchemy.orm import relationship

from app.db.base_class import Base
from app.utils.mixins import TimestampMixin


class Subnet(TimestampMixin, Base):
    subnet = Column(String, nullable=True)
    ips = relationship("Ip", cascade="delete, all", back_populates="subnet")
    __table_args__ = (
        UniqueConstraint("subnet", "project_id", name="unique_subnet"),
        {},
    )
    is_approved = Column(Boolean, default=True)
    is_scanned = Column(Boolean, default=False)
    project_id = Column(Integer, ForeignKey("project.id", ondelete="CASCADE"))
    project = relationship("Project", back_populates="domains")
